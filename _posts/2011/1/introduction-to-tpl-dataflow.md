---
title: Introduction to TPL Dataflow
date: 2011-01-04 11:47:00 -08:00
permalink: /2011/01/04/introduction-to-tpl-dataflow/
categories:
- Solution
tags:
- .NET
---
<p>In Octobre 2010, Microsoft <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=d5b3e1f8-c672-48e8-baf8-94f05b431f5c&amp;displaylang=en">released a white paper</a> on an oncoming library in the .NET Framework, the Task Parallel Library DataFlow.</p>  <p><img style="border-bottom:0;border-left:0;display:inline;margin-left:0;border-top:0;margin-right:0;border-right:0;" title="image" border="0" alt="image" align="right" src="/assets/posts/2011/1/introduction-to-tpl-dataflow/image2.png" width="404" height="265" />The dataflow library is built on top of the Task Parallel Library (TPL) included in .NET 4.0.&#160; Basically, the TPL provides the building block for task-oriented Frameworks.&#160; The dataflow library also integrates with new language support for tasks in C# (e.g. async).&#160; Finally, and not the least, the library inherits the work done in the Concurrency &amp; Coordination Runtime (CCR), from Microsoft Robotics.</p>  <p>The library attempts to model flows of data.&#160; The building blocks are source and target components.&#160; Basically, you pump data into a source and it pushes it to its network of target in an asynchronously fashion.</p>  <ul>In many ways, it does promote the actor / agent-oriented design.&#160; This design style facilitates parallelism since state (messages) flows from agent to agent asynchronously and no states are shared.</ul>  <ul>For now, only a CTP is available.&#160; From the looks of it, it seems extremely code-intense.&#160; I believe it will require a designer to make it useful.&#160; It’s a bit like Workflow Foundation without the designer right-now:&#160; a lot of good ideas but the amount of work to use it is way too high to make it worthwhile.</ul>  <ul>The foundation is great though.&#160; The parallel team at Microsoft obviously have a clear vision of where they want to go in tomorrow’s multi-core world.&#160; They are seeding the building blocks for a new way to develop applications making it easy to leverage the multiple cores of modern devices.</ul>  <ul>Today, parallelism is hard.&#160; Sure, you can throw a couple of calls to TaskFactory or your beloved thread-pool.&#160; But how do you handle IO parallelism?&#160; For instance, you’re doing a call to your DB-server on an ASP.NET thread.&#160; Do you use async-page model?&#160; Have you tried doing that?&#160; Not trivial, hen?&#160; Well, unless you do that (and %99.99 ASP.NET applications don’t), you’re blocking an ASP.NET thread where you could simply wait on an I/O port.&#160; Just for that type of scenario, it’s clear we need new tools to develop parallelism.</ul>  <ul>The Task Parallel Library goes a long way to make it easy to generate work with threads, but it doesn’t go the whole way to alleviate the pain of synchronizing work.&#160; This is where the CCR made a lot of headways:&#160; it didn’t focus on threads, not even on work, it focused on coordination of work.&#160; This is what the TPL Dataflow inherited.</ul>