---
title: Single VM SLA
date: 2016-11-23 11:43:03 -05:00
permalink: /2016/11/23/single-vm-sla/
categories:
- Solution
tags:
- Virtual Machines
---
<p><a href="/assets/2016/11/single-vm-sla/seal-1771694_640.png"><img title="seal-1771694_640" style="background-image:none;float:left;padding-top:0;padding-left:0;display:inline;padding-right:0;border-width:0;" border="0" alt="seal-1771694_640" src="/assets/2016/11/single-vm-sla/seal-1771694_640_thumb.png" width="480" align="left" height="480"/></a> By now you’ve probably heard the news:&nbsp; <a href="https://azure.microsoft.com/en-us/blog/announcing-4-tb-for-sap-hana-single-instance-sla-and-hybrid-use-benefit-images/" target="_blank">Azure became the first Public Cloud to offer SLA on single VM</a>.</p> <p>This was announced on Monday, November 21st.</p> <p>In this article, I’ll quickly explore what that means.</p> <h2>Multi-VMs SLA</h2> <p>Before that announcement, in order to have SLA on connectivity to compute, <a href="https://azure.microsoft.com/en-us/support/legal/sla/virtual-machines/v1_0/" target="_blank">we needed to have 2 or more VMs in an Availability Set</a>.</p> <p>This was and still is the High Availability solution.&nbsp; It gives an SLA of %99.95 availability, measured monthly.</p> <p>There is no constrain on the storage used (Standard or Premium) and the SLA includes planned maintenance and any failures.&nbsp; So basically, we put 2+ VMs in an availability set and we’re good all the time.</p> <h2>Single-VM SLA</h2> <p>The new SLA has a few constraints.</p> <ul> <li>The SLA isn’t the same.&nbsp; Single-VM SLA is only %99.9 (as opposed to %99.95).</li> <li>VMs must use Premium storage for both OS &amp; Data disks.&nbsp; Presumably, Premium Storage has a better reliability.&nbsp; This is interesting since in <a href="https://azure.microsoft.com/en-us/support/legal/sla/storage/v1_1/" target="_blank">terms of SLA</a>, there are no distinction between Premium &amp; Standard.</li> <li>Single VM SLA doesn’t include planned maintenance.&nbsp; This is important.&nbsp; It means we are covered with %99.9 availability as long as there are no planned maintenance.&nbsp; More on that below.</li> <li>SLA is calculated on a monthly basis, as if the VM was up the entire month…&nbsp; this means that if our VM is up the entire month, it has an SLA of %99.9.&nbsp; If, on the contrary, we turn it off 12 hours / day, we won’t have %99.9 SLA on the 12 hours / day we are using it.</li> <li>Since this was announced on November 21st, we can expect it to take effect 30 days later ; to be on the safe side, I tell customers January 1st, 2017</li></ul> <p>So, it is quite important to state that it isn’t a simple extension of the existing SLA to a single-VM.&nbsp; But it is very useful nonetheless.</p> <h2>Planned maintenance</h2> <p>I just wanted to expand a bit on planned maintenance.</p> <p>What is a planned maintenance?&nbsp; Once in a while Azure needs some maintenance which requires a shutdown of hosts.&nbsp; Either the host itself gets updated (software / hardware) or it gets decommissioned altogether.&nbsp; In those cases, the underlying VMs are shutdown, the host is rebooted (or decommissioned, in which case the VMs get relocated) and then the VM are booted back.</p> <p>This is a downtime for a VM.</p> <p>With an Highly Available configuration, i.e. 2+ VMs in Availability Set, the downtime of one VM doesn’t affect the availability of the availability set since <a href="https://vincentlauzon.com/2015/10/21/azure-basics-availability-sets/">there is a guarantee that there will always be one VM available</a>.</p> <p>Without an Highly Available configuration, there is no such guarantee.&nbsp; For that reason, I suppose, this downtime isn’t covered within the SLA.&nbsp; Remember, %99.9 on a monthly basis means 43 minutes of downtime per month.&nbsp; A planned maintenance would easily take a few minutes of downtime:&nbsp; taking into account the VMs shutdown (all of the VMs on the host), the host restart and the VM boot.&nbsp; That isn’t negligible compare to the 43 minutes of margin the SLA gives.</p> <p>This would leave very little margin of manoeuver for potential hardware / software failures during the month.</p> <p>Now, that isn’t the end of the world.&nbsp; For quite a few months we have the <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-windows-redeploy-to-new-node" target="_blank">redeploy me now feature</a> in Azure.&nbsp; This feature redeploys the VM to a new host.&nbsp; If there is a planned maintenance in course in the Data Center, the new host should be an updated one already, in which case our VM won’t need a reboot anymore.</p> <p>Planned maintenance follow a workflow where a notification is sent a week in advance subscription owner (see <a title="https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-windows-planned-maintenance" href="https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-windows-planned-maintenance">https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-windows-planned-maintenance</a> &amp; <a title="https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-linux-planned-maintenance?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json" href="https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-linux-planned-maintenance">https://docs.microsoft.com/en-us/azure/virtual-machines/virtual-machines-linux-planned-maintenance</a>).&nbsp; We can then trigger a redeploy at our earliest convenience (maintenance window).</p> <p>Alternatively, we can trigger a redeploy every week, during a maintenance window and ignore notification emails.</p> <h2>High Availability</h2> <p>The previous section should have convinced you that Single-VM SLA isn’t a replacement for an Highly Available (HA) configuration.</p> <p>On top of the Azure planned maintenance being outside the SLA, our own solution maintenance will impact the SLA of the solution.</p> <p>In an HA configuration, we can take an instance down, update it, put it back, then upgrade the next one.</p> <p>With a single VM we cannot do that and a solution maintenance will incur a downtime and should therefore be done inside maintenance window (of the solution).</p> <p>For those reason, I still recommend to customers to use an HA configurations if HA is a requirement.</p> <h2>Enabled scenarios</h2> <p>What Single VM brings isn’t a cheaper HA configuration.&nbsp; Instead, it enables non-HA configuration <strong>with SLA</strong> in Azure.</p> <p>Until now, there were two modes.&nbsp; Either we took the HA route or we lived without an SLA.</p> <p>Often No SLA is ok.&nbsp; For dev &amp; test scenarios for instance, SLA is rarely required.</p> <p>Often HA is required.&nbsp; For most production scenarios I deal with, in the enterprise space &amp; consumer facing space anyway, HA is a requirement.</p> <p>Sometimes HA doesn’t make business sense and no SLA isn’t acceptable though.&nbsp; HA might not make business sense when</p> <ul> <li>The solution doesn’t support HA ; this is sadly the case for a lot of legacy application</li> <li>The solution supports HA with a premium license, which itself doesn’t make business sense</li> <li>Having HA increases the number of VMs to a point where the management of the solution would be cost prohibitive</li></ul> <p>For those scenarios, the single-VM SLA might hit the sweet spot.</p>