---
title: Training a model to predict failures
date: 2016-05-11 20:00:03 -04:00
permalink: /2016/05/11/training-a-model-to-predict-failures/
categories:
- Solution
tags:
- Machine Learning
---
<p>Today a quick entry to talk about a twist on Machine Learning for the <em>predictive maintenance </em>problem.</p> <p>The <em>Microsoft Cortana Intelligence team </em>wrote an interesting blog the other day:&nbsp; <a href="https://blogs.technet.microsoft.com/machinelearning/2016/04/19/evaluating-failure-prediction-models-for-predictive-maintenance/" target="_blank">Evaluating Failure Prediction Models for Predictive Maintenance</a>.</p> <p>When you listen to all the buzz around Machine Learning, it sometimes feels as if we’ve solved all the ML problems and you just need to point your engine in the general direction of your data for it to spew some insights.&nbsp; <em>Not yet</em>.</p> <p><a href="/assets/2016/5/training-a-model-to-predict-failures/thumb-794696_640.png"><img title="thumb-794696_640" style="border-top:0;border-right:0;background-image:none;border-bottom:0;float:left;padding-top:0;padding-left:0;border-left:0;display:inline;padding-right:0;" border="0" alt="thumb-794696_640" src="/assets/2016/5/training-a-model-to-predict-failures/thumb-794696_640_thumb.png" width="240" align="left" height="240"/></a>That article highlights a challenge with predictive maintenance.&nbsp; Predictive maintenance is about predicting when a failure (of a device, hardware, process, etc.) will occur.&nbsp; But…&nbsp; you typically have very few failures:&nbsp; your data set is completely <em>imbalanced</em> between success samples and failure samples.</p> <p>If you go <em>heads on </em>and train a model with your data set, a likely outcome is that your model will predict success %100 of the time.&nbsp; This is because it doesn’t get penalized that much by ignoring the few failures and gets rewarded by not missing any success.</p> <p>Remember that <a href="https://vincentlauzon.com/2015/07/02/machine-learning-an-introduction-part-1/">Machine Learning is about optimizing a cost function over a sample set</a> (training set).&nbsp; I like to draw the comparison with humans on a social system with metrics (e.g. bonus in a job, laws in society, etc.):&nbsp; humans will find any loophole in a metric in order to maximize it and rip the reward.&nbsp; So does Machine Learning.&nbsp; You therefore have to be on the lookout for those loopholes.</p> <p>With predictive maintenance, failures often cost a lot of money, sometimes more than a false positive (i.e. a non-failure identified as a failure).&nbsp; For this reason, you don’t want to miss failures:&nbsp; you want to <strong>compensate</strong> for the imbalance in your data set.</p> <p>The article, <a href="https://blogs.technet.microsoft.com/machinelearning/2016/04/19/evaluating-failure-prediction-models-for-predictive-maintenance/" target="_blank">which I suggest you read in full when you’ll need to apply it</a>, suggests 3 ways to compensate for the lack of failures in your data set:</p> <ol> <li>You can resample the failures to increase their occurrence ; for instance by using the <a href="https://msdn.microsoft.com/en-us/library/azure/dn913076.aspx" target="_blank">Synthetic Minority Oversampling Technique</a> (SMOTE) readily available in <a href="https://azure.microsoft.com/en-us/services/machine-learning/" target="_blank">Azure ML</a>.</li> <li>Tune the hyper-parameters of your model (e.g. by using a <a href="https://msdn.microsoft.com/library/azure/038d91b6-c2f2-42a1-9215-1f2c20ed1b40/" target="_blank">parameter sweep</a>, also readily available in Azure ML) to optimize for recall.</li> <li>Change the metric to penalize false negative more than false positive.</li></ol> <p>This is just one of the many twists you have to think of when creating a predictive model.</p> <p>My basic advice:&nbsp; make sure you not only <a href="https://vincentlauzon.com/2016/04/17/how-to-do-data-science/">ask the right question</a> but with the right <em>carrot &amp; stick</em> <img class="wlEmoticon wlEmoticon-winkingsmile" style="border-style:none;" alt="Winking smile" src="/assets/2016/5/training-a-model-to-predict-failures/wlemoticon-winkingsmile.png"/>&nbsp; If a failure, to you, costs more than a success identified as a failure (i.e. a false positive), then factor this in to your model.</p>